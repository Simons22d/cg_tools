from tools import app, db
from flask import request, render_template
from tools.utils.utils import get_issue_count, filename, excel, error_icon, slow_icon, success_icon
from flask import jsonify, send_from_directory
from flask_sqlalchemy import sqlalchemy

from tools.models.models import Bike, BranchReports, Category, CategorySchema, BikeSchema, BranchReportsSchema, \
    Branch, BranchSchema, Severity, SeveritySchema, User, UserSchema, Reminder, ReminderSchema

from tools.utils.utils import (send_mail, remind_users, email_info, user_has_submitted, get_by_type_branch,
                               get_status_by_category_and_duration, get_status_by_category_and_branch, maximum_value,
                               bootstrap_test, daily_report_data, email_report_body, email_report_body, reports_image)
from flask_mail import Message
from tools import mail
from datetime import datetime
from dateutil import parser
import pandas as pd
import imgkit

branch_cat_schema = BranchReportsSchema()
branches_cat_schema = BranchReportsSchema(many=True)

category_schema = CategorySchema()
categories_schema = CategorySchema(many=True)

bike_schema = BikeSchema()
bikes_schema = BikeSchema(many=True)

branch_schema = BranchSchema()
branches_schema = BranchSchema(many=True)

severity_schema = SeveritySchema()
severties_schema = SeveritySchema(many=True)

user_schema = UserSchema()
users_schema = UserSchema(many=True)

reminder_schema = ReminderSchema()
reminders_schema = ReminderSchema(many=True)


@app.route("/branch/report/download/<string:filename>")
def download(filename):
    return send_from_directory("files", filename=filename)


@app.route("/bike/add", methods=["GET", "POST"])
def add_bike():
    plate_number = request.json["plate_number"]
    email = request.json["email"]
    branch = request.json["branch"]
    serial_number = request.json["serial_number"]

    lookup = Bike(plate_number, email, branch, serial_number)
    db.session.add(lookup)
    db.session.commit()

    return jsonify(bike_schema.dump(lookup))


@app.route("/bike/get/single", methods=["POST", "GET"])
def get_single_bike():
    id = request.json["id"]
    lookup = Bike.query.get(id)
    return jsonify(bike_schema.dump(lookup))


@app.route("/bike/get/all", methods=["POST", "GET"])
def get_all_bikes():
    lookup = Bike.query.all()
    return jsonify(bikes_schema.dump(lookup))


@app.route("/bike/search", methods=["POST"])
def search_bikes():
    term = request.json['term']
    term = term.strip()
    lookup = Bike.query.all()
    # lookup = Bike.query.filter(Bike.plate_number.like(term)).all()
    # or Bike.query.filter(Bike.serial_number.like(term)).all()
    return jsonify(bikes_schema.dump(lookup))


@app.route("/daily/report", methods=["GET", "POST"])
def daily_reports():
    data = daily_report_data()
    icons = [success_icon(), slow_icon(), error_icon()]

    data_ = dict()
    users = User.query.all()
    users_ = users_schema.dump(users)
    final = list()

    for user in users_:
        branch = Branch.query.get(user["branch"])
        user.update({"branch": branch_schema.dump(branch)["name"]})
        final.append(user)

    return render_template("reports.html", data=data["reports"], date=data["date"], icons=icons, users=final)


@app.route("/branch/image", methods=['POST', "GET"])
def x__():
    config_path = r'C:\Program Files\wkhtmltopdf\bin\wkhtmltopdf.exe'

    imgkit.from_url('http://localhost:9000/daily/report', 'out.jpg')
    return dict()


@app.route("/department/inform", methods=['POST'])
def department_inform():
    send_mail("denniskiruku@gmail.com", "daily branch report", email_report_body(image_()),attachment="image.txt")
    return jsonify({}), 200


def image_():
    return """ 
            data:image/png;base64,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
"""


@app.route("/branch/report/add", methods=['POST', 'GET'])
def add_branch_report():
    # get all categories
    categories = Category.query.all()
    branch = request.json["branch"]
    data = request.json["data"]
    for category in categories:
        category_id = int(category.id)
        severity = int(data[category.name.lower()]["severity"])
        comments = data[category.name.lower()]["comments"]
        if comments.strip():
            # adding to the DB
            lookup = BranchReports(branch, severity, category_id, comments)
            db.session.add(lookup)
            db.session.commit()
            data = data
        else:
            data = {}

    return jsonify(data)


@app.route("/branch/report/get/single", methods=["GET", "POST"])
def get_single_branch():
    branch_id = request.json["branch_id"]
    lookup = BranchReports.query.get(branch_id)
    return jsonify(branch_cat_schema.dump(lookup))


@app.route("/branch/report/get/all", methods=["POST", "GET"])
def get_all_branches():
    lookup = BranchReports.query.all()
    return jsonify(branches_cat_schema.dump(lookup))


@app.route("/category/seed", methods=["POST"])
def seed_category():
    categories = ["SAP", "ETR", 'Networks', "Emails", "Printers", "Mpesa"]
    for category in categories:
        lookup = Category(category)
        db.session.add(lookup)
        db.session.commit()
    return jsonify(categories)


@app.route("/branch/report/category/get/single", methods=["GET", "POST"])
def category_get_single():
    category_id = request.json["id"]
    lookup = Category.query.get(category_id)
    return jsonify(category_schema.ump(lookup))


@app.route("/branch/report/category/get/all", methods=["GET", "POST"])
def category_get_all():
    lookup = Category.query.all()
    return jsonify(categories_schema.dump(lookup))


@app.route("/reports/branch", methods=["GET", "POST"])
def branch_reports():
    """
    > bike reports
    > branch reports
    >
    """
    category = request.json["category"]
    start = request.json["start"]
    end = request.json["end"]
    return jsonify(list())


@app.route("/branch/seed", methods=['POST'])
def seed_branches():
    branches = ["kitengela", "HQ", "nanyuki", "mombasa", "malindi", "voi", "kisumu", 'kitale', 'kisii', 'eldoret',
                'bungoma', 'kericho', 'naruku', 'cummins']
    for branch in branches:
        lookup = Branch(branch.lower().capitalize())
        try:
            db.session.add(lookup)
            db.session.commit()
        except sqlalchemy.exc.IntegrityError:
            return jsonify({"msg": "Error! Records exists"}), 500
    return jsonify({"msg": "success"}), 201


@app.route("/severity/seed", methods=["GET", "POST"])
def seed_categories():
    categories = [
        {"name": "okay", "weight": 1},
        {"name": "slow", "weight": 2},
        {"name": "not functional", "weight": 3}
    ]

    for category in categories:
        lookup = Severity(category["name"].lower().capitalize(), category["weight"])
        try:
            db.session.add(lookup)
            db.session.commit()
        except sqlalchemy.exc.IntegrityError:
            return jsonify({"msg": "Error! Categories exists"})
    return jsonify({"msg": "Success! Categories Added Successfully"})


@app.route("/branch/get/all", methods=["POST"])
def get_branches():
    lookup = Branch.query.all()
    return jsonify(branches_schema.dump(lookup))


@app.route("/category/get/all", methods=["POST", "GET"])
def get_categories():
    lookup = Category.query.all()
    return jsonify(categories_schema.dump(lookup))


@app.route("/severity/get/all", methods=["POST", "GET"])
def get_severity():
    lookup = Severity.query.all()
    return jsonify(severties_schema.dump(lookup))


@app.route("/send/email", methods=['POST', 'GET'])
def send_email_():
    from_ = request.json["from"]
    to = request.json["to"]
    subject = request.json["subject"]
    body = request.json["body"]
    return send_mail(from_, to, subject, body)


@app.route("/send/email/template", methods=['POST', 'GET'])
def send_email_template():
    from_ = "itsupport@cargen.com"
    to = "denniskiruku@gmail.com"
    subject = "TEMPLATE EMAIL"
    body = email_report_body()
    return send_mail(to, subject, body)


@app.route('/user/seed', methods=["POST"])
def add_user_seed():
    users = [
        {"email": "denniskiruku@gmail.com", "name": "Denis Kiruku", "branch": 1},
        {"email": "kirukuwambui@gmail.com", "name": "Kiruku Wambui", "branch": 1}
    ]
    for user in users:
        lookup = User(user["email"], user["name"], user["branch"])
        try:
            db.session.add(lookup)
            db.session.commit()
        except sqlalchemy.exc.IntegrityError:
            return jsonify({"msg": "Error! User exists"})
    return jsonify(user)


@app.route('/user/add', methods=["POST"])
def add_user_():
    name = request.json["name"]
    email_ = request.json["email"]
    branch = request.json["branch"]
    lookup = User(email_, name, branch)
    try:
        db.session.add(lookup)
        db.session.commit()
    except sqlalchemy.exc.IntegrityError:
        return jsonify({"msg": "Error! User exists"})
    return jsonify(user_schema.dump(lookup))


@app.route('/branch/users/get', methods=["GET", "POST"])
def get_branch_users():
    users = User.query.all()
    users_ = users_schema.dump(users)
    final = list()
    for user in users_:
        branch = Branch.query.get(user["branch"])
        user.update({"branch": branch_schema.dump(branch)["name"]})
        final.append(user)
    return jsonify(final)


@app.route("/branch/user/remove", methods=["GET", "POST"])
def remove_user():
    email = request.json["email"]
    data = User.query.filter_by(email=email).first()
    db.session.delete(data)
    db.session.commit()
    return jsonify(user_schema.dump(data))


@app.route("/branch/todays/submit", methods=["POST", "GET"])
def get_lastest_update():
    data = daily_report_data()
    return jsonify(data)


@app.route("/branch/todays/submit/single", methods=["POST"])
def get_lastest_update_():
    branch = request.json["branch"]
    date = datetime.now().strftime("%Y-%m-%d")
    date_ = datetime.now().strftime("%A, %d %b %Y")
    # sort last per branch
    lookup = db.session.execute(f"SELECT b.*, brd.* "
                                f"FROM branch b "
                                f"INNER JOIN branch_reports brd "
                                f"ON b.id = brd.branch "
                                f"AND brd.branch = {branch} "
                                f"AND brd.date_added "
                                f"LIKE '%{date}%' "
                                f"ORDER BY brd.date_added DESC")

    return jsonify({"data": [dict(row) for row in lookup], "date": date_})


@app.route("/send/email/reminder", methods=["POST"])
def remind():
    return remind_users()


@app.route("/has/submitted", methods=["POST"])
def sdfsdf():
    user = request.json["user_id"]
    return jsonify({'msg': user_has_submitted(user)})


@app.route('/email', methods=["POST"])
def email():
    return send_mail("denis.kiruku@cargen.com", "tests from localhost", "Just like any other body")


@app.route('/email/2', methods=["POST"])
def email_2():
    msg = Message("Tests ....", sender="itsupport@cargen.com", recipients=["denis.kiruku@cargen.com"])
    mail.send(msg)
    return dict()


@app.route("/branch/report", methods=["POST"])
def branch_reports_():
    date = request.json["date"]
    category = request.json["category"]
    parsed = parser.parse(date)

    date_ = parsed.strftime("%Y-%m-%d")
    final = dict()
    filename = f"Branch Report {date_}.xlsx"
    if int(category) == 1000:
        sss = dict()
        branches = Branch.query.all()

        for branch in branches:
            data = db.session.execute(f"SELECT br.comments, ct.name, sv.name AS Severity, b.name AS Branch FROM "
                                      f"branch_reports br INNER JOIN category ct ON br.category = ct.id INNER JOIN "
                                      f"severity sv ON br.severity = sv.id INNER JOIN branch b ON br.branch = b.id "
                                      f"AND br.branch = {branch.id} WHERE date_added LIKE '%{date_}%'")
            ccc = dict()
            comnts = ""
            if data:
                pro = [dict(x) for x in data]
                for x in pro:
                    print(x)
                    ccc.update({x["name"].upper(): x["Severity"]})
                    comnts += f"{x['name'].upper()} - {x['comments']};   "
                    ccc.update({"comments".upper(): comnts})

            sss.update({branch.name.upper(): ccc})
        df = pd.DataFrame(sss).T
        df.to_excel(f"/home/dev/cg_tools/tools/files/{filename}")

    else:

        sss = dict()
        branch = Branch.query.get(int(category))
        if branch:
            data = db.session.execute(
                f"SELECT br.comments, ct.name, sv.name AS Severity, b.name AS Branch FROM branch_reports br INNER JOIN"
                f" category ct ON br.category = ct.id INNER JOIN severity sv ON br.severity = sv.id INNER JOIN branch"
                f" b ON br.branch = b.id AND br.branch = {branch.id} WHERE date_added LIKE '%{date_}%'")
            ccc = dict()
            comnts = ""
            pro = [dict(x) for x in data]
            print(pro)
            if pro:
                for x in pro:
                    print(x)
                    ccc.update({x["name"].upper(): x["Severity"]})
                    comnts += f"{x['name'].upper()} - {x['comments']};   "
                    ccc.update({"comments".upper(): comnts})

            sss.update({branch.name.upper(): ccc})
            df = pd.DataFrame(sss).T
            filename = f"Branch Report {branch.name} {date_}.xlsx"
            df.to_excel(f"/home/dev/cg_tools/tools/files/{filename}")

    return jsonify({"filename": filename})


@app.route("/dashboard")
def dashboard():
    pass


@app.route("/branch/by/type", methods=['POST'])
def __xx():
    type = request.json["type"]
    branch = request.json["branch"]
    return jsonify(branches_cat_schema.dump(get_by_type_branch(type, branch)))


@app.route("/all/most/status", methods=["POST"])
def most_failed_all():
    date = request.json["date"]
    duration = request.json["duration"]  # daily,weekly,monthly,yearly
    status = request.json["status"]  # {1: ok, 2: slow, 3: Not Functional }
    data = get_status_by_category_and_duration(date, duration, status)
    return jsonify({"data": data, "maximum": maximum_value(data)})


@app.route("/branch/most/status", methods=["POST"])
def most_failed_branch():
    date = request.json["date"]
    branch = request.json["branch"]
    duration = request.json["duration"]  # daily,weekly,monthly,yearly
    status = request.json["status"]
    # maximum_value
    data = get_status_by_category_and_branch(branch, date, duration, status)
    return jsonify({"data": data, "maximum": maximum_value(data)})


@app.route("/bootstrap", methods=["POST"])
def bootstrapper():
    return jsonify(bootstrap_test())


@app.route("/project/reports")
def project_reports():
    pass
